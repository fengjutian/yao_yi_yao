<view class="container">
  <!-- 顶部添加按钮 -->
  <view class="header-actions">
    <t-button
      theme="primary"
      size="large"
      variant="outline"
      icon="add"
      bind:tap="openAddModal"
    >
      添加店铺
    </t-button>
  </view>

  <!-- 店铺列表 -->
  <view wx:if="{{list.length > 0}}" class="store-list">
    <view class="list-title">我的店铺</view>
    <view
      class="store-card"
      wx:for="{{list}}"
      wx:key="_id"
    >
      <!-- 左侧照片 -->
      <view class="card-photo" bindtap="previewPhoto" data-url="{{item.photoUrl}}">
        <image
          wx:if="{{item.photoUrl}}"
          class="store-photo"
          src="{{item.photoUrl}}"
          mode="aspectFill"
        />
        <view wx:else class="no-photo">
          <t-icon name="shop" size="48rpx" color="#ddd" />
        </view>
      </view>

      <!-- 中间信息 -->
      <view class="card-content">
        <view class="store-name">{{item.name}}</view>
        <view class="store-info">
          <t-tag size="small" variant="light" theme="primary">{{item.category}}</t-tag>
          <text wx:if="{{item.address}}" class="store-address">{{item.address}}</text>
        </view>
      </view>

      <!-- 右侧操作 -->
      <view class="card-actions">
        <t-icon
          name="edit"
          size="48rpx"
          color="#0052D9"
          class="action-btn"
          bind:tap="editStore"
          data-item="{{item}}"
        />
        <t-icon
          name="delete"
          size="48rpx"
          color="#ff4d4f"
          class="action-btn"
          bind:tap="deleteStore"
          data-item="{{item}}"
        />
      </view>
    </view>
  </view>

  <!-- 空状态 -->
  <view wx:if="{{list.length === 0}}" class="empty-state">
    <t-icon name="shop" size="120rpx" color="#ddd" />
    <text class="empty-text">暂无店铺</text>
    <text class="empty-hint">点击"添加店铺"按钮添加第一家店铺吧</text>
  </view>

  <!-- 模态框 -->
  <t-dialog
    visible="{{showModal}}"
    title="{{editingId ? '编辑店铺' : '添加店铺'}}"
    confirmBtn="{{editingId ? '更新' : '添加'}}"
    bind:confirm="saveStore"
    bind:cancel="closeModal"
  >
    <view slot="content" class="modal-content">
      <!-- 店铺名称 -->
      <t-input
        label="店铺名称 *"
        placeholder="请输入店铺名称"
        value="{{name}}"
        bind:change="onNameInput"
        clearable
      />

      <!-- 店铺地址 -->
      <t-input
        label="店铺地址"
        placeholder="请输入店铺地址"
        value="{{address}}"
        bind:change="onAddressInput"
        clearable
      />

      <!-- 分类选择 -->
      <view class="form-group">
        <text class="label">分类 *</text>
        <t-picker
          value="{{category}}"
          range="{{categories}}"
          bind:change="onCategoryChange"
          placeholder="请选择分类"
        />
      </view>

      <!-- 照片上传 -->
      <view class="form-group">
        <text class="label">店铺照片</text>
        <view class="photo-upload">
          <image
            wx:if="{{photoUrl}}"
            class="photo"
            src="{{photoUrl}}"
            mode="aspectFill"
            bindtap="previewPhoto"
            data-url="{{photoUrl}}"
          />
          <view wx:else class="photo-placeholder" bindtap="choosePhoto">
            <t-icon name="add" size="48rpx" color="#999" />
            <text class="upload-text">点击上传照片</text>
          </view>
        </view>
      </view>
    </view>
  </t-dialog>
</view>
